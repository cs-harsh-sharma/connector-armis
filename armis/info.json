{
  "name": "armis",
  "label": "Armis",
  "description": "Armis connector provides protection from cyber threats created by the onslaught of unmanaged and IoT devices. This connector facilitates operations to get alerts and devices list, update status of alerts, tag and untag devices etc.",
  "category": "Asset Management",
  "version": "1.0.0",
  "publisher": "Fortinet",
  "cs_approved": false,
  "cs_compatible": true,
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "help_online": "",
  "configuration": {
    "fields": [
      {
        "title": "Server URL",
        "name": "server_url",
        "type": "text",
        "description": "URL of the Armis server to which you will connect and perform the automated operations.",
        "placeholder": "Please enter the server URL",
        "required": true,
        "editable": true,
        "visible": true
      },
      {
        "title": "API Key",
        "type": "password",
        "name": "api_key",
        "required": true,
        "editable": true,
        "visible": true,
        "description": "API key to access the Armis endpoint to which you will connect and perform the automated operations."
      },
      {
        "title": "Verify SSL",
        "name": "verify_ssl",
        "type": "checkbox",
        "description": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True.",
        "required": false,
        "editable": true,
        "visible": true,
        "value": true
      }
    ]
  },
  "operations": [
    {
      "operation": "get_alerts",
      "title": "Get Alerts List",
      "description": "Retrieves a detailed list of alerts from the Armis server based on the search criteria specified.",
      "category": "investigation",
      "annotation": "get_alerts",
      "output_schema": {
        "Armis": {
            "Alert": {
                "activityIds": [],
                "activityUUIDs": [],
                "alertId": "",
                "connectionIds": [],
                "description": "",
                "deviceIds": [],
                "severity": "",
                "status": "",
                "time": "",
                "title": "",
                "type": ""
            }
        }
      },
      "enabled": true,
      "parameters": [
        {
          "title": "Alert ID",
          "name": "alert_id",
          "type": "text",
          "tooltip": "ID of the alert to retrieve its details from the Armis server.",
          "description": "(Optional) ID of the alert to retrieve its details from the Armis server.",
          "required": false,
          "editable": true,
          "visible": true
        },
        {
          "title": "Time Frame",
          "name": "time_frame",
          "type": "text",
          "tooltip": "Specify the time frame to retrieve the alerts from Armis server. By default time frame is 1 week.",
          "description": "(Optional) Specify the time frame to retrieve the alerts from Armis server. By default time frame is 1 week.",
          "required": false,
          "editable": true,
          "visible": true,
          "placeholder": "e.g. 10 Days"
        },
        {
          "title": "Risk Level",
          "name": "risk_level",
          "type": "multiselect",
          "tooltip": "Risk Level of the alert that you want to retrieve from Armis server.",
          "description": "(Optional) Risk Level of the alert that you want to retrieve from Armis server.",
          "options": [
            "High",
            "Medium",
            "Low"
          ],
          "required": false,
          "editable": true,
          "visible": true
        },
        {
          "title": "Status",
          "name": "status",
          "type": "multiselect",
          "tooltip": "Status of the alert that you want to retrieve from Armis server.",
          "description": "(Optional) Status of the alert that you want to retrieve from Armis server.",
          "options": [
            "UNHANDLED",
            "SUPPRESSED",
            "RESOLVED"
          ],
          "required": false,
          "editable": true,
          "visible": true
        },
        {
          "title": "Alert Type",
          "name": "alert_type",
          "type": "multiselect",
          "tooltip": "Retrieves the alerts for specified alert type from Armis server.",
          "description": "(Optional) Retrieves the alerts for specified alert type from Armis server.",
          "options": [
            "Policy Violation",
            "System Policy Violation",
            "Anomaly Detection"
          ],
          "required": false,
          "editable": true,
          "visible": true
        },
        {
          "title": "Max Alerts",
          "name": "max_alerts",
          "type": "integer",
          "tooltip": "Helps in limiting response to a specified number of alerts.",
          "description": "(Optional) Maximum number of alerts that you want this operation to return in the response.",
          "required": false,
          "editable": true,
          "visible": true
        }
      ]
    },
    {
      "operation": "update_alert_status",
      "title": "Update Alert Status",
      "description": "Update status of specific alert on the Armis server based on alert ID you have specified.",
      "category": "investigation",
      "annotation": "update_alert_status",
      "output_schema": {
        "status": "",
        "message": ""
      },
      "enabled": true,
      "parameters": [
        {
          "title": "Alert ID",
          "name": "alert_id",
          "type": "text",
          "tooltip": "Alert ID to update its status on the Armis server.",
          "description": "Alert ID to update its status on the Armis server.",
          "required": true,
          "editable": true,
          "visible": true,
          "value": ""
        },
        {
          "title": "Status",
          "name": "status",
          "type": "select",
          "tooltip": "Status of the alert that you want to update on Armis server.",
          "description": "Status of the alert that you want to update on Armis server.",
          "options": [
            "UNHANDLED",
            "SUPPRESSED",
            "RESOLVED"
          ],
          "required": true,
          "editable": true,
          "visible": true,
          "value": ""
        }
      ]
    },
    {
      "operation": "get_alerts_by_asq",
      "title": "Get Alerts By Armis Standard Query",
      "description": "Retrieves a detailed list of alerts from the Armis server based on the Armis Standard Query specified.",
      "category": "investigation",
      "annotation": "get_alerts_by_asq",
      "output_schema": {
          "Armis": {
              "Alert": {
                  "activityIds": [],
                  "activityUUIDs": [],
                  "alertId": "",
                  "connectionIds": [],
                  "description": "",
                  "deviceIds": [],
                  "severity": "",
                  "status": "",
                  "time": "",
                  "title": "",
                  "type": ""
              }
          }
      },
      "enabled": true,
      "parameters": [
        {
          "title": "Armis Standard Query",
          "name": "query_string",
          "type": "text",
          "tooltip": "Retrieves alerts from the Armis server based on the Armis Standard Query you have specified.",
          "description": "(Optional) Retrieves alerts from the Armis server based on the Armis Standard Query you have specified.",
          "required": false,
          "editable": true,
          "visible": true,
          "placeholder": "timeFrame:\"7 Days\""
        },
        {
          "title": "Max Alerts",
          "name": "max_alerts",
          "type": "integer",
          "tooltip": "Helps in limiting response to a specified number of alerts.",
          "description": "(Optional) Maximum number of alerts that you want this operation to return in the response.",
          "required": false,
          "editable": true,
          "visible": true,
          "value": ""
        }
      ]
    },
    {
      "operation": "add_device_tags",
      "title": "Add Tags to a Device",
      "description": "Adds tags to a Device based on the device ID.",
      "category": "investigation",
      "annotation": "add_device_tags",
      "output_schema": {
        "status": "",
        "message": ""
      },
      "enabled": true,
      "parameters": [
        {
          "title": "Device ID",
          "name": "device_id",
          "type": "text",
          "tooltip": "Device ID to which you will add tags to on Armis server.",
          "description": "Device ID to which you will add tags to on Armis server.",
          "required": true,
          "editable": true,
          "visible": true,
          "value": ""
        },
        {
          "title": "Tags",
          "name": "tags",
          "type": "text",
          "tooltip": "The comma separated list of tags you want to add to the specified device.",
          "description": "The comma separated list of tags you want to add to the specified device.",
          "required": true,
          "editable": true,
          "visible": true,
          "placeholder": "e.g. Tag1, Tag2",
          "value": ""
        }
      ]
    },
    {
      "operation": "remove_device_tags",
      "title": "Remove Tags from a Device",
      "description": "Removes tags from a Device based on the device ID.",
      "category": "investigation",
      "annotation": "remove_device_tags",
      "output_schema": {
        "status": "",
        "message": ""
      },
      "enabled": true,
      "parameters": [
        {
          "title": "Device ID",
          "name": "device_id",
          "type": "text",
          "tooltip": "Device ID from which you will remove tags from on Armis server.",
          "description": "Device ID from which you will remove tags from on Armis server.",
          "required": true,
          "editable": true,
          "visible": true,
          "value": ""
        },
        {
          "title": "Tags",
          "name": "tags",
          "type": "text",
          "tooltip": "The comma separated list of tags you want to remove from the specified device.",
          "description": "The comma separated list of tags you want to remove from the specified device.",
          "required": true,
          "editable": true,
          "visible": true,
          "placeholder": "e.g. Tag1, Tag2",
          "value": ""
        }
      ]
    },
    {
      "operation": "get_devices",
      "title": "Get Devices List",
      "description": "Retrieves a detailed list of devices from the Armis server based on the search criteria specified.",
      "category": "investigation",
      "annotation": "get_devices",
      "output_schema": {
          "Armis": {
              "Device": {
                  "accessSwitch": "",
                  "boundaries": "",
                  "category": "",
                  "customProperties": {},
                  "dataSources": [
                      {
                          "firstSeen": "",
                          "lastSeen": "",
                          "name": "",
                          "types": []
                      },
                      {
                          "firstSeen": "",
                          "lastSeen": "",
                          "name": "",
                          "types": []
                      },
                      {
                          "firstSeen": "",
                          "lastSeen": "",
                          "name": "",
                          "types": []
                      },
                      {
                          "firstSeen": "",
                          "lastSeen": "",
                          "name": "",
                          "types": []
                      }
                  ],
                  "firstSeen": "",
                  "id": "",
                  "ipAddress": "",
                  "ipv6": "",
                  "lastSeen": "",
                  "macAddress": "",
                  "manufacturer": "",
                  "model": "",
                  "name": "",
                  "operatingSystem": "",
                  "operatingSystemVersion": "",
                  "purdueLevel": "",
                  "riskLevel": "",
                  "sensor": {
                      "name": "",
                      "type": ""
                  },
                  "site": {
                      "location": "",
                      "name": ""
                  },
                  "tags": [],
                  "type": "",
                  "userIds": [],
                  "visibility": ""
              }
          }
      },
      "enabled": true,
      "parameters": [
        {
          "title": "Device Name",
          "name": "device_name",
          "type": "text",
          "tooltip": "Device name to retrieve its details from Armis server.",
          "description": "(Optional) Device name to retrieve its details from Armis server.",
          "required": false,
          "editable": true,
          "visible": true,
          "value": ""
        },
        {
          "title": "Device ID",
          "name": "device_id",
          "type": "text",
          "tooltip": "Device ID to retrieve its details from Armis server.",
          "description": "(Optional) Device ID to retrieve its details from Armis server.",
          "required": false,
          "editable": true,
          "visible": true,
          "value": ""
        },
         {
          "title": "MAC Address",
          "name": "mac_address",
          "type": "text",
          "tooltip": "Device MAC Address to retrieve its details from Armis server.",
          "description": "(Optional) Device MAC Address to retrieve its details from Armis server.",
          "required": false,
          "editable": true,
          "visible": true,
          "value": ""
        },
        {
          "title": "IP Address",
          "name": "ip_address",
          "type": "text",
          "tooltip": "Device IP Address to retrieve its details from Armis server.",
          "description": "(Optional) Device IP Address to retrieve its details from Armis server.",
          "required": false,
          "editable": true,
          "visible": true,
          "value": ""
        },
        {
          "title": "Device Type",
          "name": "device_type",
          "type": "text",
          "tooltip": "Comma separated type of devices to retrieve from Armis server.",
          "description": "(Optional) Type of devices to retrieve from Armis server.",
          "required": false,
          "editable": true,
          "visible": true,
          "placeholder": " e.g. Ip Camera,Plc",
          "value": ""
        },
        {
          "title": "Risk Level",
          "name": "risk_level",
          "type": "multiselect",
          "tooltip": "Risk level of the devices that you want to retrieve from Armis server.",
          "description": "(Optional) Risk level of the devices that you want to retrieve from Armis server..",
          "options": [
            "High",
            "Medium",
            "Low"
          ],
          "required": false,
          "editable": true,
          "visible": true,
          "value": ""
        },
        {
          "title": "Time Frame",
          "name": "time_frame",
          "type": "text",
          "tooltip": "Specify the time frame to retrieve the devices from Armis server.",
          "description": "(Optional) Specify the time frame to retrieve the devices from Armis server.",
          "required": false,
          "editable": true,
          "visible": true,
          "value": "",
          "placeholder": "e.g. 10 Days"
        },
        {
          "title": "Max Devices",
          "name": "max_devices",
          "type": "integer",
          "tooltip": "Helps in limiting response to a specified number of devices.",
          "description": "(Optional) Maximum number of devices that you want this operation to return in the response.",
          "required": false,
          "editable": true,
          "visible": true,
          "value": ""
        }
      ]
    },
    {
      "operation": "get_devices_by_asq",
      "title": "Get Devices By Armis Standard Query",
      "description": "Retrieves a detailed list of devices from the Armis server based on the Armis Standard Query specified.",
      "category": "investigation",
      "annotation": "get_devices_by_asq",
      "output_schema": {
          "Armis": {
              "Device": {
                  "accessSwitch": "",
                  "category": "",
                  "dataSources": [
                      {
                          "firstSeen": "",
                          "lastSeen": "",
                          "name": "",
                          "types": []
                      },
                      {
                          "firstSeen": "",
                          "lastSeen": "",
                          "name": "",
                          "types": []
                      },
                      {
                          "firstSeen": "",
                          "lastSeen": "",
                          "name": "",
                          "types": []
                      }
                  ],
                  "firstSeen": "",
                  "id": "",
                  "ipAddress": "",
                  "ipv6": "",
                  "lastSeen": "",
                  "macAddress": "",
                  "manufacturer": "",
                  "model": "",
                  "name": "",
                  "operatingSystem": "",
                  "operatingSystemVersion": "",
                  "riskLevel": "",
                  "sensor": {
                      "name": "",
                      "type": ""
                  },
                  "site": {
                      "location": "",
                      "name": ""
                  },
                  "tags": [],
                  "type": "",
                  "user": "",
                  "visibility": ""
              }
          }
      },
      "enabled": true,
      "parameters": [
        {
          "title": "Armis Standard Query",
          "name": "query_string",
          "type": "text",
          "tooltip": "Retrieves devices from the Armis server based on the Armis Standard Query you have specified.",
          "description": "(Optional) Retrieves devices from the Armis server based on the Armis Standard Query you have specified.",
          "required": false,
          "editable": true,
          "visible": true,
          "placeholder": "timeFrame:\"7 Days\""
        },
        {
          "title": "Max Devices",
          "name": "max_devices",
          "type": "integer",
          "tooltip": "Helps in limiting response to a specified number of devices.",
          "description": "(Optional) Maximum number of devices that you want this operation to return in the response.",
          "required": false,
          "editable": true,
          "visible": true,
          "value": ""
        }
      ]
    }
  ]
}


